# twine_japan - Tweego + SugarCube + PWA + GitHub Pages (Option B)

Quick start:

```bash
bash scripts/get_tweego.sh
bash scripts/build.sh
# open dist/index.html
```

## Build process overview

The project is authored as Tweego-compatible `.twee` stories in `stories/` and
compiled into static HTML decks. The local build script performs the following:

1. `scripts/get_tweego.sh` downloads the Tweego binary into `.bin/` (re-used
   across runs via caching in CI).
2. `scripts/build.sh` cleans `dist/`, runs Tweego with the SugarCube format to
   produce an `index.html` for each deck, copies shared assets, injects the PWA
   service worker, and writes a directory-level index page.
3. The output under `dist/` can be opened locally or published as the static
   site.

## Continuous integration & deployment

GitHub Actions automate the build and release flow:

- **Build Pages (Tweego + PWA)** (`.github/workflows/pages.yml`) runs on every
  pull request and push. It checks out the repository, installs Tweego, and
  executes the same build script used locally. Push events additionally clone
  the `gh-pages` branch, copy the freshly built `dist/` output into it (adding a
  `.nojekyll` marker), and regenerate the root index. Commits to non-`main`
  branches are prefixed with `z_staging_` so previews remain isolated.
- **Deploy GitHub Pages from Branch** (`.github/workflows/gh-pages-deploy.yml`)
  listens for updates to the `gh-pages` branch. It packages the branch contents
  as a Pages artifact and publishes it to the `github-pages` environment.

## Role of the `gh-pages` branch and GitHub Pages

The `gh-pages` branch holds the compiled static site that GitHub Pages serves.
Source code changes land on `main`, the build workflow refreshes the generated
files in `gh-pages`, and the deploy workflow then releases those files to GitHub
Pages. As a result, visiting the repository's GitHub Pages URL loads the latest
PWA-enabled stories that were generated by CI. The branch is not meant for
hand-edited changes; it is treated as a publish-only artifact of the automated
build pipeline.
